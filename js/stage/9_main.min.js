$(function(){function n(n,t){console.log("Particle Spawned!");var o=new PIXI.Sprite(j[0]);return o.interactive=o.buttonMode=!1,o.anchor.x=o.anchor.y=.5,o.position.x=n,o.position.y=t,o.ticks=0,o.limit=0+4*Math.random()-1|0,o.subImg=0,o.removed=!1,o.g=.02*Math.random(),o.v={x:y.randomFlip(.8),y:0},o.tick=function(){this.ticks++,this.ticks>this.limit&&(this.ticks=0,this.texture=j[this.subImg++%j.length]),this.rotation+=.001,this.subImg>=j.length&&this.kill(),this.move()},o.move=function(){this.v.y+=this.g,this.x+=this.v.x,this.y+=this.v.y},o.kill=function(){this.removed=!0},o}function t(t,o,e,i){if(window.running){if(!t||!o){var a=$("#lamp");if(a)try{for(var c=l?40:100,u=0;c>u;u++)if(t=a.position().left+Math.random()*a.width(),o=a.position().top+Math.random()*a.height(),P.contains(t,o)){o+=a.height()/4,console.log("Inside Polygon ["+t+"]["+o+"]! "+u+" attempts.");break}}catch(h){return window.running=!0,r(),void console.log(h)}}if(x){var d=new n(t,o),v=e||1;i&&(v+=Math.random()*(i-e)|0,0>v&&(v=-v)),d.scale.x=d.scale.y=v||1,D.push(d),U.addChild(d)}else s(t,o,e,i)}}function o(){t(null,null,1,2),x&&t(null,null,3,4)}function e(){if(k+=.33,x)for(var n=0;k/3>n;n++)t();x,o(),k>4&&!G&&(G=!0,setTimeout(r,2e3))}function i(){function n(){e(n)}function e(n){var e=$("#lamp");u+=l;var i=c+u,r=a;i>r&&(i=r-(i-r),1>h?(k+=u/(20*(3*h+1)),o(),o(),o()):(k-=u/(15*(1*h+1)),o()),t(),console.log("bounce speed: "+u|0),u=-(u/1.8),h++),e.css({top:i}),c=i,d>h?setTimeout(n,v):e.css({top:a})}var i=$("#lamp"),a=w.y;console.log(a);var r=1.2*-i.height();console.log("new: "+r),i.css("top",r-50),console.log("new real position: "+i.position().top);var s=r,c=s;console.log("from: "+s);var l=3,u=10,h=0,d=4;n()}function a(){function n(){e(n)}function t(){o(t)}function o(n){I++;for(var t=[],o=0;o<D.length;o++){var e=D[o];e.removed?(U.removeChild(e),console.log("particle removed.")):(e.tick(),t.push(e))}D=t,R.render(F),window.running&&setTimeout(n,g)}function e(n){p++;var t=$("#lamp");if(t){if(k>0){var o=Math.sin(p++/(5*m))*k*2;t.rotate(o)}k*=.99,.2>k&&(k=.2)}window.running&&setTimeout(n,v)}n(),console.log("Rendering Started!"),x&&(t(),console.log("Ticking Started!"))}function r(){if(z)return!1;z=!0;var n=3e3,t=$("#video_container"),o=$("#video_id");t.fadeIn(n,function(){window.running=!1;try{o[0].player.play()}catch(n){console.log(n)}}),$("#lamp").animate({opacity:0},n,function(){$(this).remove()}),x&&$(M).animate({opacity:0},n,function(){$(this).remove()})}function s(n,t){console.log("Spawning Jquery Particles");var o=$("<img>").attr({src:"img/"+A[K++%A.length]+".gif"});o.addClass("trail");var e=n-o.width()/2,i=t+2*o.height()+10,a=1e3,r=e+(6*Math.random()-3)*(a>>7),s=i+6*Math.random()*(a>>7),c={opacity:0,left:r,top:s};$(document.body).append(o),o.css({position:"absolute",left:e,top:i}).animate(c,a,function(){$(this).remove()})}var c=~"localhost".indexOf(document.URL);(!console||c)&&(console={log:function(){}});var l=WURFL?WURFL.is_mobile:!0,u=960,h=window.innerHeight,d=20,v=1e3/d,f=25,g=1e3/f,p=0,m=1;window.running=!0;var w={x:70,y:200},y={isCanvasSupported:function(){var n=document.createElement("canvas");return!(!n.getContext||!n.getContext("2d"))},movePolygon:function(n,t,o){if(!(n.length<2))for(var e=0;e<n.length;e+=2)n[e]+=t,n[e+1]+=o},drawPolygon:function(n,t){if(!(t.length<2)){var o=n,e=0;for(o.moveTo(t[e++],t[e++]);e<t.length-1;)o.lineTo(t[e++],t[e++]);o.endFill()}},distance:function(n,t){var o=t.x-n.x,e=t.y-n.y;return Math.sqrt(o*o+e*e)},randomFlip:function(n){return n=Math.abs(n),2*Math.random()*n-n}},x=y.isCanvasSupported();y.isCanvasSupported=function(){return x},$("#lamp").rotate(0);var I=0,b=$("#container"),k=($("#lamp"),0),C=[0,100,420,0,740,50,750,250,510,350,300,350,0,160],P={data:C,points:function(){for(var n=[],t=0,o=C.length;o>t;t+=2)n.push({x:C[t],y:C[t+1]});return n}(),contains:function(n,t){for(var o=!1,e=0,i=this.points.length-1;e<this.points.length;i=e++){var a=this.points[e].x,r=this.points[e].y,s=this.points[i].x,c=this.points[i].y,l=r>t!=c>t&&(s-a)*(t-r)/(c-r)+a>n;l&&(o=!o)}return o}};if(x){var M,X=u||window.innerWidth,S=h||window.innerHeight,T="canvasContainer";M=document.createElement("canvas"),$("#"+T).append(M),M&&"object"==typeof M||(console.log("Canvas not available, using no canvas fallback."),y.isCanvasSupported=function(){return!1});var F=new PIXI.Stage(546),R=PIXI.autoDetectRenderer(X,S,M,!0);if(R.view.style.position="absolute",R.view.style.top="0px",R.view.style.left="0px",!c){var E=new PIXI.Graphics;E.beginFill(60928,.1),y.movePolygon(C,w.x,w.y),y.drawPolygon(E,C),F.addChild(E)}var Y=l?6:12,_=0,L=!0,U=new PIXI.SpriteBatch;F.addChild(U);for(var W=PIXI.Texture.fromImage("img/sparkle_sheet.png"),j=[],q=32,H=32,O=0;8>O;O++)for(var B=0;4>B;B++)j.push(new PIXI.Texture(W,new PIXI.Rectangle(O*q,B*H,q,H)));var D=[]}var G=!1;b.on("click",function(){return e(),!1}),i(),a();var J=!0;!function(){function n(){J&&t.fadeIn(o,function(){t.fadeOut(o,n)})}var t=$("#glow"),o=1e3;t&&n()}();var z=!1,A=["twinkle","gcspinny","sparkles29jc","sparkle"],K=0;!function(){function t(n){if(a){var t={x:n.pageX,y:n.pageY},o=y.distance(t,a);o>u/4&&(e(),a=t)}else a={x:n.pageX,y:n.pageY}}function o(o){if(window.running){t(o);var e={x:o.pageX,y:o.pageY};if(_++,Y>_)return!1;if(_=0,L)for(var i=0;d>i;i++){var a=new n(e.x+5*i,e.y);a.v.x+=.15*i,a.v.y+=.2,a.scale.x=a.scale.y=l?2:1,D.push(a),U.addChild(a)}return!1}}function i(n){if(window.running&&(t(n),s++,!(r>s))){s=0;var o=$("<img>").attr({src:"img/"+A[K++%A.length]+".gif"});o.addClass("trail");var e=n.pageX-o.width()/2,i=n.pageY-o.height()/2,a=1e3,c=e+(6*Math.random()-3)*(a>>7),l=i+6*Math.random()*(a>>7),u={opacity:0,left:c,top:l};return $(document.body).append(o),o.css({position:"absolute",left:e,top:i}).animate(u,a,function(){$(this).remove()}),!1}}var a,r=10,s=0,c=2,h=1,d=l?h:c;$(document).mousemove(function(n){return x?o(n):i(n),!1});try{$(document).on("touchmove",function(n){var t=n.originalEvent.touches[0]||n.originalEvent.changedTouches[0];return x?o(t):i(t),!1})}catch(v){console.log(v)}}()});