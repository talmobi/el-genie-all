$(function(){function n(n,t){console.log("Particle Spawned!");var i=new PIXI.Sprite(W[0]);return i.interactive=i.buttonMode=!1,i.anchor.x=i.anchor.y=.5,i.position.x=n,i.position.y=t,i.ticks=0,i.limit=0+4*Math.random()-1|0,i.subImg=0,i.removed=!1,i.g=.02*Math.random(),i.v={x:w.randomFlip(.8),y:0},i.tick=function(){this.ticks++,this.ticks>this.limit&&(this.ticks=0,this.texture=W[this.subImg++%W.length]),this.rotation+=.001,this.subImg>=W.length&&this.kill(),this.move()},i.move=function(){this.v.y+=this.g,this.x+=this.v.x,this.y+=this.v.y},i.kill=function(){this.removed=!0},i}function t(t,i,o,e){if(window.running){if(!t||!i){var a=$("#lamp");if(a)try{for(var c=l?40:100,u=0;c>u;u++)if(t=a.position().left+Math.random()*a.width(),i=a.position().top+Math.random()*a.height(),P.contains(t,i)){i+=a.height()/4,console.log("Inside Polygon ["+t+"]["+i+"]! "+u+" attempts.");break}}catch(d){return window.running=!0,r(),void console.log(d)}}if(x){var h=new n(t,i),f=o||1;e&&(f+=Math.random()*(e-o)|0,0>f&&(f=-f)),h.scale.x=h.scale.y=f||1,B.push(h),U.addChild(h)}else s(t,i,o,e)}}function i(){t(null,null,1,2),x&&t(null,null,3,4)}function o(){b+=.4,l&&(b+=.3),b*=1.1;var n=8;if(b>n&&(b=n),x&&!l)for(var o=0;b/3>o;o++)t();x,i(),b>4&&!G&&(G=!0,setTimeout(r,1e3))}function e(){function n(){o(n)}function o(n){var o=$("#lamp");d+=u;var e=c+d,r=a;e>r&&(e=r-(e-r),1>h?(b+=d/(20*(3*h+1)),i(),i(),i()):(b-=d/(15*(1*h+1)),i()),t(),d=-(d/1.8),h++),o.css({top:e}),c=e,v>h?setTimeout(n,f*u):o.css({top:a})}var e=$("#lamp"),a=y.y,r=1.2*-e.height();e.css("top",r-200);var s=r,c=s,u=l?.4:.25,d=2,h=0,v=4;n()}function a(){function n(){o(n)}function t(){i(t)}function i(n){I++;for(var t=[],i=0;i<B.length;i++){var o=B[i];o.removed?U.removeChild(o):(o.tick(),t.push(o))}B=t,R.render(_),window.running&&setTimeout(n,p)}function o(n){g++;var t=$("#lamp");if(t){if(b>0){var i=Math.sin(g++/(5*m))*b*2;t.rotate(i)}b*=.99,.2>b&&(b=.2)}window.running&&setTimeout(n,f)}n(),console.log("Rendering Started!"),x&&(t(),console.log("Ticking Started!"))}function r(){if(A)return!1;A=!0;var n=3e3,t=$("#video_container"),i=$("#video_id");t.fadeIn(n,function(){window.running=!1;try{l||i[0].player.play()}catch(n){console.log(n)}}),$("#lamp").animate({opacity:0},n,function(){$(this).remove()}),$("#hand_id").animate({opacity:0},n/1.2,function(){z=!1,$("#hand_id").css({display:"none"})}),x&&$(M).animate({opacity:0},n,function(){$(this).remove()})}function s(n,t){console.log("Spawning Jquery Particles");var i=$("<img>").attr({src:"img/"+K[N++%K.length]+".gif"});i.addClass("trail");var o=n-i.width()/2,e=t+2*i.height()+10,a=1e3,r=o+(6*Math.random()-3)*(a>>7),s=e+6*Math.random()*(a>>7),c={opacity:0,left:r,top:s};$(document.body).append(i),i.css({position:"absolute",left:o,top:e}).animate(c,a,function(){$(this).remove()})}var c=(~"localhost".indexOf(document.URL),"localhost".indexOf(document.URL));c=!1,console&&c||(console={log:function(){}});var l=!0;WURFL&&"Desktop"===WURFL.form_factor&&(l=!1);var u=960,d=window.innerHeight,h=20,f=1e3/h,v=25,p=1e3/v,g=0,m=1;window.running=!0;var y={x:70,y:200},w={isCanvasSupported:function(){var n=document.createElement("canvas");return!(!n.getContext||!n.getContext("2d"))},movePolygon:function(n,t,i){if(!(n.length<2))for(var o=0;o<n.length;o+=2)n[o]+=t,n[o+1]+=i},drawPolygon:function(n,t){if(!(t.length<2)){var i=n,o=0;for(i.moveTo(t[o++],t[o++]);o<t.length-1;)i.lineTo(t[o++],t[o++]);i.endFill()}},distance:function(n,t){var i=t.x-n.x,o=t.y-n.y;return Math.sqrt(i*i+o*o)},randomFlip:function(n){return n=Math.abs(n),2*Math.random()*n-n}},x=w.isCanvasSupported();w.isCanvasSupported=function(){return x},$("#lamp").rotate(0);var I=0,k=$("#container"),b=($("#lamp"),0),C=[0,100,420,0,740,50,750,250,510,350,300,350,0,160],P={data:C,points:function(){for(var n=[],t=0,i=C.length;i>t;t+=2)n.push({x:C[t],y:C[t+1]});return n}(),contains:function(n,t){for(var i=!1,o=0,e=this.points.length-1;o<this.points.length;e=o++){var a=this.points[o].x,r=this.points[o].y,s=this.points[e].x,c=this.points[e].y,l=r>t!=c>t&&(s-a)*(t-r)/(c-r)+a>n;l&&(i=!i)}return i}};if(x){var M,X=u||window.innerWidth,S=d||window.innerHeight,T="canvasContainer";M=document.createElement("canvas"),$("#"+T).append(M),M&&"object"==typeof M||(console.log("Canvas not available, using no canvas fallback."),w.isCanvasSupported=function(){return!1});var _=new PIXI.Stage(546),R=PIXI.autoDetectRenderer(X,S,M,!0);if(R.view.style.position="absolute",R.view.style.top="0px",R.view.style.left="0px",c){var F=new PIXI.Graphics;F.beginFill(60928,.1),w.movePolygon(C,y.x,y.y),w.drawPolygon(F,C),_.addChild(F)}var Y=l?6:12,E=0,L=!0,U=new PIXI.SpriteBatch;_.addChild(U);for(var O=PIXI.Texture.fromImage("img/sparkle_sheet.png"),W=[],j=32,q=32,D=0;8>D;D++)for(var H=0;4>H;H++)W.push(new PIXI.Texture(O,new PIXI.Rectangle(D*j,H*q,j,q)));var B=[]}var G=!1;k.on("click",function(){return o(),!1}),e(),a();var J=!0;!function(){function n(){J&&t.fadeIn(i,function(){t.fadeOut(i,n)})}var t=$("#glow"),i=1e3;t&&n()}();var z=!0,A=!1,K=["twinkle","gcspinny","sparkles29jc","sparkle"],N=0;!function(){function t(n){if(a){var t={x:n.pageX,y:n.pageY},i=w.distance(t,a);i>u/5&&(o(),a=t)}else a={x:n.pageX,y:n.pageY}}function i(i){if(window.running){t(i);var o={x:i.pageX,y:i.pageY};if(E++,Y>E)return!1;if(E=0,L)for(var e=0;h>e;e++){var a=new n(o.x+5*e,o.y);a.v.x+=.15*e,a.v.y+=.2,a.scale.x=a.scale.y=l?2:1,B.push(a),U.addChild(a)}return!1}}function e(n){if(window.running&&(t(n),s++,!(r>s))){s=0;var i=$("<img>").attr({src:"img/"+K[N++%K.length]+".gif"});i.addClass("trail");var o=n.pageX-i.width()/2,e=n.pageY-i.height()/2,a=1e3,c=o+(6*Math.random()-3)*(a>>7),l=e+6*Math.random()*(a>>7),u={opacity:0,left:c,top:l};return $(document.body).append(i),i.css({position:"absolute",left:o,top:e}).animate(u,a,function(){$(this).remove()}),!1}}var a,r=10,s=0,c=2,d=1,h=l?d:c;$(document).mousemove(function(n){return x?i(n):e(n),!1});try{$(document).on("touchmove",function(n){var t=n.originalEvent.touches[0]||n.originalEvent.changedTouches[0];return x?i(t):e(t),!1})}catch(f){console.log(f)}}(),l?$("#hand_id").hide():($("#hand_id").show(),$(document).mousemove(function(n){$("#hand_id").offset({left:n.pageX,top:n.pageY})}))});